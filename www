#!/bin/bash
# abstract: browser launcher

firefox_running=$(sdorfehs -c windows | grep -i firefox | perl -pe 's/\d+[+*]//')

if [[ $(hostname) = "x1" ]]; then
  # current screen number of the active monitor
  active_monitor=$(sdorfehs -c sdump|sed -E 's/,/\n/g'|grep -P ' 1$'|awk '{print $2}')

  if [[ $active_monitor = 1 ]]; then
    # middle monitor, use vscreen profiles
    if [[! -z $firefox_running ]]; then
      fx_vscreen_profiles "$@"
    else
      wmctrl -a firefox
    fi
  else
    if [[! -z $firefox_running ]]; then
      fx_screen_profiles "$@"
    else
      wmctrl -a firefox
    fi
  fi
elif [[ $(hostname) = "fantomen" ]]; then
  # current screen number of the active monitor
  # 2 = middle
  CURRENT_SCREEN=$(sdorfehs -c sdump|sed -E 's/,/\n/g'|grep -P ' 1$'|awk '{print $2}')

  # if we are on the middle screen we want to use the vscreen profiles on the
  # other monitors we can use the screen_profiles since vscreens are hardly
  # used there
  if [[ $CURRENT_SCREEN == 2 ]]; then
    echo $CURRENT_SCREEN
    if [[! -z $firefox_running ]]; then
      fx_vscreen_profiles "$@"
    else
      wmctrl -a firefox
    fi
  else
    if [[! -z $firefox_running ]]; then
      fx_screen_profiles "$@"
    else
      wmctrl -a firefox
    fi
  fi
else
    firefox
fi

# remember to execute add_userchrome_to_all_profiles.zsh once done
